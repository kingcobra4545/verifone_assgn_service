#include <jni.h>
#include <string>
#include <android/log.h>

#define TAG "SignatureVerifier"
#define LOGI(...) __android_log_print(ANDROID_LOG_INFO, TAG, __VA_ARGS__)

const char *trustedSignature = "3082037d30820265a003020102020805ba2ec3f09022e4300d06092a864886f70d01010c0500306c3110300e06035504061307556e6b6e6f776e3110300e06035504081307556e6b6e6f776e3110300e06035504071307556e6b6e6f776e3110300e060355040a1307556e6b6e6f776e3110300e060355040b1307556e6b6e6f776e3110300e06035504031307556e6b6e6f776e3020170d3235303630383134313734385a180f32303532313032343134313734385a306c3110300e06035504061307556e6b6e6f776e3110300e06035504081307556e6b6e6f776e3110300e06035504071307556e6b6e6f776e3110300e060355040a1307556e6b6e6f776e3110300e060355040b1307556e6b6e6f776e3110300e06035504031307556e6b6e6f776e30820122300d06092a864886f70d01010105000382010f003082010a0282010100e2347c1cdedf5fb2eb48bcafa5e820b53a706a27766376abfd594ab5e2e7ea784025ad34f3aa95cc55db1c2ed414ccc5cd1186e34a272882c62faa8e1b942ab1608aafd10aba11abc3ddeb9914af739b2ea9e6decc576a6d3fa24bcf2383899a3d2b60bdc284397bad15ddd83437698884c1f5829a3e6e4155f7f7a662065501ea85a4010546a4bcf40d5d3da5bbb28fae38d9db2092a68893fa80dd26931377b06304137fb76e4045661ecc87c6364f1ede754a97c12e1a96389e4fd83c12784094c842b23246790b7ced7e2480d1e4b971e8407c6582736fb5c972ff336ceb7e98d3bf670f64a252f39ab9d17367f8e7cb61aac1e6765f01cda1016f0236190203010001a321301f301d0603551d0e04160414192d48f1b9bee5eafb7daba7c933dcd3df19022d300d06092a864886f70d01010c0500038201010053c68b4579fda2bc981a368c3ec6225579897348b6c63c8114e7d859ab01e853deb95bd93c5686d1a2768733ae1740ed712c573f0883560b409c372a25eec44b2395cd98b1cd164136e924de445ef396d4b809e819382d3110c9c81ba1c4df15f11b5a13e62af8438b1357dbedf79740b67737be137a2bd04159e5007bbefdf1b230cbf9b60f109e7068a2c0835fc4e1d5dd52e532d0f703179a3e9d83bb86e2b8ff228e69fd58fcf1f1e8d9830fd0b4cd684344279c27a1b2289d323800bedc8006e0c66d878fbafd09eca04bc96e538e605fed2082bfbc6c09c276a720bd440dbe780ab38e65ea9700ccc78f938980df362512e99ffd3beb9b2f512970dcbd";

extern "C"
JNIEXPORT jboolean JNICALL
Java_com_prajwal_analyticsserviceapp_native_SignatureVerifier_nativeVerifySignature(
        JNIEnv *env, jobject thiz, jstring input_signature) {

    const char *input = env->GetStringUTFChars(input_signature, nullptr);
    bool isTrusted = (strcmp(input, trustedSignature) == 0);

    LOGI("Signature match: %s", isTrusted ? "true" : "false");

    env->ReleaseStringUTFChars(input_signature, input);
    return isTrusted;
}
